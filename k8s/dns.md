
# REF
- https://arisu1000.tistory.com/27859

# 쿠버네티스 DNS

쿠버네티스에서는 클러스터 내부에서만 사용가능한 DNS를 설정해놓고 사용할 수 있다. 그래서 포드간 통신을 할때나 IP가 아닌 도메인을 설정해 두고 사용할 수 있다. 그렇게 한 클러스터에서 아용하던 yaml 파일에서 포드간 통신을 도메인으로 설정해 둔다면 별다른 수정없기 그대로 다른 클러스터로 가져가서 사용하는 것도 가능하다.

ip로 통신하도록 되어있다면 한곳에 세팅해놨던 yaml 파일을 다른곳으로 옮겨 가져가서 사용하려고 할때 그 클러스터에서 사용하는 ip 대역이 다른것이라면 그대로 사용할 수 가 없게 된다. 이럴때 설정이 도메인을 사용하도록 되어 있다면 별다른 수정없이 그대로 사용할 수 있다.

그 뿐만 아니라 일부의 경우에는 서비스디스커버리(service discovery) 용도로 사용할 수 있다. 전문적인 서비스디스커버리를 사용하려면 dns가 아니라 다른 솔루션들을 사용해야 하겠지만 간단한 경우라면 dns를 이용해서 할 수도 있다. 

특정 pod들에 접근하려할때 도메인을 통해서 접근하도록 설정되어 있다면 pod에 문제가 생겨서 재생성되거나 배포때문에 재생성될때 IP가 변경되더라도 자동으로 도메인에 변경된 pod의 IP가 등록되기 때문에 자연스레 새로 시작된 pod 쪽으로 연결하는 것이 가능하다

## 클러스터내에서 도메인사용해보기

쿠버네티스에서 사용하는 내부 도메인은 service와 pod에 대해서 사용할 수 있고 일정한 패턴을 가지고 있다.

특정 서비스에 접근하는 도메인은 다음처럼 구성된다.

**aname**이라는 네임스페이스에 속한 **bservice**가 있다고 했을때 이 서비스에 접근하는 도멘인은 **bservice.aname.svc.cluster.local**이 된다. **bservice.aname** 순으로 서비스와 네임스페이스를 연결한 다음에 마지막에 **svc.cluster.local**을 붙이면 된다.

특정 pod에 접근하는 도메인은 다음처럼 구성된다.
default 네임스페이스에 속한 **cpod(10.10.10.10)**이라는 이름의 pod에 대한 도메인은 다음처럼 구성된다.
**10-10-10-10.default**

